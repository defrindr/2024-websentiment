{% extends 'Admin/layout.html' %}

{% block title %} {{title}} {% endblock %}

{% block content %}

{% import "Admin/_components/macros.html" as macros %}
{{macros.breadcrumb(title)}}
{{macros.alert()}}


<div class="row">
  <div class="col-md-12 mb-2">
    <div class="card">
      <div class="card-header">
        <a href="{{url_for( module + '.index')}}" class="btn btn-danger mb-2">
          <i class="mdi mdi-back"></i> Kembali
        </a>
      </div>
      <div class="card-body">

        <form action="{{url_for(module + '.store')}}" class="form" method="post"
          onsubmit="return confirm('Apakah Anda Yakin ?')" enctype="multipart/form-data">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

          <div class="form-group">
            <label for="judul">Judul</label>
            <div class="row">
              <div class="col-md-10 mb-2">
                <input type="text" class="form-control" name="judul" id="judul" required>
              </div>
              <div class="col-md-2 mb-2">
                <button onclick="event.preventDefault();CariKategori(event)" class="btn btn-primary btn-block">
                  <i class="fa fa-search"></i>
                </button>
              </div>
            </div>
          </div>


          <div class="form-group">
            <label for="isi">Isi</label>
            <textarea rows="5" class="form-control" name="isi"></textarea>
          </div>

          <div class="form-group">
            <label for="kategori">Kategori</label>
            <select class="form-control" name="kategoriId" id="kategori">
              <option value="">-- Pilih Kategori --</option>
              {% for category in categories %}
              <option value="{{category.id}}">
                {{category.name}}
              </option>
              {% endfor %}
            </select>
          </div>

          <div class="form-group">
            <button class="btn btn-primary">
              <i class="ion ion-md-save"></i>
              Submit
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}


{% block js%}
<script>
  const CariKategori = (event) => {
    let judul = $('#judul').val();
    console.log(judul)

    fetch("{{ url_for('admin.berita.nb') }}?judul=" + judul).then(res => res.json()).then(res => {
      $('#kategori option:eq(' + res.category + ')').prop('selected', true)
    }).catch(e => {
      console.error(e)
    })
  }
</script>
{% endblock %}